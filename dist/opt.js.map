{"version":3,"sources":["webpack:///webpack/bootstrap e72967a1f8219007268f?2701","webpack:///./src/options.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qE;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,kD;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,MAAK;;AAEL;AACA;AACA,wDAAuD,kBAAkB;AACzE;AACA;;AAEA;AACA;AACA;AACA;AACA,0CAAyC,yCAAyC;AAClF;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2D;AACA;AACA;AACA,gD;AACA;AACA,qBAAoB;AACpB;AACA;AACA,qBAAoB;;AAEpB;AACA,SAAQ;;AAER;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA,qBAAoB,E;AACpB;AACA,SAAQ;;;AAGR;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qE;AACA;;AAEA,MAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,yBAAyB;AAC9D,sCAAqC,6BAA6B;AAClE;;AAEA,MAAK;;AAEL;;AAEA;;AAEA;AACA;AACA,UAAS;AACT,qDAAoD,2CAA2C;AAC/F;AACA;;AAEA;AACA;AACA,UAAS;AACT,qDAAoD,mDAAmD;AACvG;AACA;;AAEA;AACA;AACA,UAAS;AACT,qDAAoD,6CAA6C;AACjG;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,kBAAiB;AACjB;AACA,MAAK;;AAEL;;AAEA;AACA;AACA,UAAS;AACT;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;;AAGL;AACA;AACA;AACA,MAAK;;;AAGL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,qDAAoD,iDAAiD;AACrG;AACA;AACA,6DAA4D,0BAA0B;AACtF;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;;AAGL;;AAEA;;AAEA;;AAEA,2BAA0B,oEAAoE;;AAE9F;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,kBAAiB;;AAEjB;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;;AAEA;;AAEA;AACA;AACA,eAAc,iBAAiB,EAAE;;AAEjC;AACA;;AAEA;AACA;AACA;AACA,EAAC,E","file":"opt.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e72967a1f8219007268f\n **/","var OptionsController = function () {\r\n\r\n    this.protocolCheck_ = document.getElementById('protocol-checkbox');\r\n    this.protocolLabel_ = document.getElementById('input-group-wallabagurl');\r\n    this.wallabagurlinput_ = document.getElementById('input-wallabagurl');\r\n    this.checkedLabel_ = document.getElementById(\"checked-label\");\r\n    this.versionLabel_ = document.getElementById(\"apiversion-label\");\r\n    this.checkurlbutton_ = document.getElementById('checkurl-button');\r\n    this.tokenSection_ = document.getElementById(\"token-section\");\r\n\r\n    this.clientId_ = document.getElementById(\"clientid-input\");\r\n    this.clientSecret_ = document.getElementById(\"clientsecret-input\");\r\n    this.userLogin_ = document.getElementById(\"userlogin-input\");\r\n    this.userPassword_ = document.getElementById(\"userpassword-input\");\r\n    this.getAppTokenButton_ = document.getElementById(\"getapptoken-button\");\r\n\r\n    //  this.appTokenInput_ = document.getElementById(\"apptoken-input\");\r\n    this.tokenLabel_ = document.getElementById(\"apitoken-label\");\r\n    //  this.checkTokenButton_ = document.getElementById(\"checktoken-button\");\r\n\r\n    //  this.refrTokenInput_ = document.getElementById(\"refreshtoken-input\");\r\n    //   this.refreshTokenButton_ = document.getElementById(\"refreshtoken-button\");\r\n\r\n    //   this.tokenExpiresInput = document.getElementById(\"tokenexpired-input\");\r\n\r\n   this.saveToFileButton = document.getElementById(\"saveToFile-button\");\r\n   this.loadFromFileButton = document.getElementById(\"loadFromFile-button\");\r\n   this.clearButton = document.getElementById(\"clear-button\");\r\n   this.openFileDialog = document.getElementById(\"openFile-dialog\");    \r\n\r\n   this.saveToLocalButton = document.getElementById(\"saveToLocal-button\");\r\n    this.addListeners_();\r\n\r\n};\r\n\r\n\r\nOptionsController.prototype = {\r\n\r\n    protocolCheck_: null,\r\n    protocolLabel_: null,\r\n    wallabagurlinput_: null,\r\n    // savebutton_: null,\r\n    checkurlbutton_: null,\r\n    versionLabel_: null,\r\n    _debug: false,\r\n    checkedLabel_: null,\r\n    tokenSection_: null,\r\n    clientId_: null,\r\n    clientSecret_: null,\r\n    userLogin_: null,\r\n    userPassword_: null,\r\n    getAppTokenButton_: null,\r\n    saveToFileButton: null,\r\n    loadFromFileButton: null,\r\n    openFileDialog: null,\r\n    clearButton: null,\r\n    saveToLocalButton: null,\r\n    //    appTokenInput_: null,\r\n    tokenLabel_: null,\r\n    //    checkTokenButton_: null,\r\n    //    refrTokenInput_: null,\r\n    //    refreshTokenButton_: null,\r\n    //    tokenExpiresInput: null,\r\n\r\n    api: null,\r\n\r\n    addListeners_: function () {\r\n        this.protocolCheck_.addEventListener('click', this.handleProtocolClick.bind(this));\r\n        // this.savebutton_.addEventListener('click', this.saveClick_.bind(this));\r\n        this.checkurlbutton_.addEventListener('click', this.checkUrlClick.bind(this));\r\n        this.getAppTokenButton_.addEventListener('click', this.getAppTokenClick.bind(this));\r\n        this.saveToFileButton.addEventListener('click', this.saveToFileClick.bind(this));\r\n        this.loadFromFileButton.addEventListener('click', this.loadFromFileClick.bind(this));\r\n        this.clearButton.addEventListener('click', this.clearClick.bind(this));\r\n        //      this.checkTokenButton_.addEventListener('click', this.checkTokenClick.bind(this));\r\n        //      this.refreshTokenButton_.addEventListener('click', this.refreshTokenClick.bind(this));\r\n        this.saveToLocalButton.addEventListener('click', this.saveToLocal.bind(this));\r\n    },\r\n\r\n    saveToLocal: function(){\r\n        this.api.saveLocal();\r\n    },\r\n\r\n    clearClick: function(){\r\n        this.userLogin_.value = '';\r\n        this.userPassword_.value = '';\r\n        this.clientSecret_.value = '';\r\n        this.clientId_.value = '';\r\n        this.wallabagurlinput_.value  = '';\r\n        this.versionLabel_.innerHTML = 'http://'; \r\n    },\r\n\r\n    loadFromFileClick: function(){\r\n        this.openFileDialog.click();\r\n        if (this.openFileDialog.value !==\"\"){\r\n            var fileToLoad = this.openFileDialog.files[0];\r\n            let fileReader = new FileReader();\r\n            fileReader.onload = function(fileLoadedEvent) \r\n            {\r\n                let textFromFileLoaded = fileLoadedEvent.target.result;\r\n                let obj = JSON.parse(textFromFileLoaded);\r\n                this.api.set(obj);\r\n                this.setFields(obj);\r\n            }.bind(this);\r\n            fileReader.readAsText(fileToLoad, \"UTF-8\");\r\n        }\r\n    },\r\n\r\n    saveToFileClick: function(){\r\n        let textToSave = JSON.stringify(this.api.data);\r\n        let textToSaveAsBlob = new Blob([textToSave], {type:\"text/plain\"});\r\n        let textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);\r\n        let fileNameToSaveAs = \"wallabag.json\";\r\n    \r\n        let downloadLink = document.createElement(\"a\");\r\n        downloadLink.download = fileNameToSaveAs;\r\n        downloadLink.innerHTML = \"Download File\";\r\n        downloadLink.href = textToSaveAsURL;\r\n        downloadLink.onclick = (event)=>{ document.body.removeChild(event.target); };\r\n        downloadLink.style.display = \"none\";\r\n        document.body.appendChild(downloadLink);\r\n        downloadLink.click();\r\n    },\r\n    // refreshTokenClick: function (e) {\r\n    //     e.preventDefault();\r\n\r\n    //     this._hide( document.getElementById(\"errorinfo\") );\r\n\r\n    //     if (this.clientId_.value != '' && this.clientSecret_.value != '' && this.refrTokenInput_.value != '') {\r\n\r\n    //         this.api.RefreshToken()\r\n    //             .then(data => {\r\n    //                 if (data != '') {\r\n    //                         console.log(data);\r\n    //                         this.appTokenInput_.value = data.access_token;\r\n    //                         this.refrTokenInput_.value = data.refresh_token;\r\n    //                         this.tokenLabel_.innerHTML = \"Granted\";\r\n    //                         let nowDate = (new Date()); \r\n    //                         let expireDate = nowDate.setSeconds(nowDate.getSeconds() + data.expires_in) ;\r\n    //                         this.tokenExpiresInput.value = new Date(  expireDate );\r\n    //                         this.api.save(); \r\n    //                 }\r\n    //             }).catch(error => {\r\n    //                 console.log(error);\r\n    //                 this.tokenLabel_.innerHTML = \"error\";\r\n    //             });\r\n\r\n    //     }\r\n    // },\r\n\r\n    // checkTokenClick: function (e) {\r\n    //     e.preventDefault();\r\n    //     if (this.appTokenInput_.value != '') {\r\n\r\n    //         this.api.CheckAppToken()\r\n    //                 .then(data => {\r\n    //                 if (data != '') {\r\n    //                     this.tokenLabel_.innerHTML = \"Checked, total articles: \"+data.total;\r\n    //                 }\r\n    //                 })\r\n    //                 .catch(error => {\r\n    //                 console.log(error);\r\n    //             }); \r\n    //     }\r\n    // },\r\n\r\n\r\n    wallabagApiTokenGot: function () {\r\n\r\n        this.api.save();\r\n\r\n        this._green(this.clientId_);\r\n        this._green(this.clientSecret_);\r\n        this._green(this.userLogin_);\r\n        this._green(this.userPassword_);\r\n        //   this.appTokenInput_.value = this.api.data.ApiToken;\r\n        //   this.refrTokenInput_.value = this.api.data.RefreshToken;\r\n        let expireDate = this.api.data.ExpireDateMs;\r\n        //   this.tokenExpiresInput.value = new Date(  expireDate ); \r\n        this.tokenLabel_.innerHTML = \"Granted\";\r\n\r\n    },\r\n\r\n    wallabagApiTokenNotGot: function () {\r\n\r\n        this._red(this.clientId_);\r\n        this._red(this.clientSecret_);\r\n        this._red(this.userLogin_);\r\n        this._red(this.userPassword_);\r\n        // this.appTokenInput_.value = '';\r\n        // this.refrTokenInput_.value = '';\r\n        // chrome.storage.local.set({ 'wallabagapptoken': '' });\r\n        // chrome.storage.local.set({ 'wallabagrefreshtoken': '' });\r\n        this.tokenLabel_.innerHTML = \"Not granted\";\r\n\r\n    },\r\n\r\n    getAppTokenClick: function (e) {\r\n\r\n        e.preventDefault();\r\n\r\n        if (this.clientId_.value == '') {\r\n            this._red(this.clientId_);\r\n        } else {\r\n            //            chrome.storage.local.set({ 'wallabagclientid': this.clientId_.value });\r\n            this._green(this.clientId_);\r\n        }\r\n\r\n        if (this.clientSecret_.value == '') {\r\n            this._red(this.clientSecret_);\r\n        } else {\r\n            //            chrome.storage.local.set({ 'wallabagclientsecret': this.clientSecret_.value });\r\n            this._green(this.clientSecret_);\r\n        }\r\n\r\n        if (this.userLogin_.value == '') {\r\n            this._red(this.userLogin_);\r\n        } else {\r\n            //            chrome.storage.local.set({ 'wallabaguserlogin': this.userLogin_.value });\r\n            this._green(this.userLogin_);\r\n        }\r\n\r\n        if (this.userPassword_.value == '') {\r\n            this._red(this.userPassword_);\r\n        } else {\r\n            this._green(this.userPassword_);\r\n        }\r\n\r\n        if (this.clientId_.value != '' && this.clientSecret_.value != '' && this.userLogin_.value && this.userPassword_.value) {\r\n            //wallabagGetAppToken: wallabagGetAppToken: function(aUrl, clientId, clientSecret, userId, userPassword){\r\n            this.api.set({\r\n                Url: this.protocolLabel_.innerText + this.wallabagurlinput_.value,\r\n                ClientId: this.clientId_.value,\r\n                ClientSecret: this.clientSecret_.value,\r\n                UserLogin: this.userLogin_.value,\r\n                UserPassword: this.userPassword_.value\r\n            }\r\n            );\r\n            this.api.GetAppToken(this.userPassword_.value)\r\n                .then(data => {\r\n//                    console.log('wallabag api token get: ' + JSON.stringify(data));\r\n                    this.wallabagApiTokenGot();\r\n                })\r\n                .catch(error => {\r\n//                    console.log('wallabag api token get error: ' + error);\r\n                    this.wallabagApiTokenNotGot();\r\n                });\r\n        }\r\n    },\r\n\r\n    handleProtocolClick: function () {\r\n\r\n        if (this.protocolCheck_.checked) {\r\n            this.protocolLabel_.innerText = 'https://'\r\n        } else {\r\n            this.protocolLabel_.innerText = 'http://'\r\n        }\r\n\r\n    },\r\n\r\n    _status: function (response) {\r\n        if (response.status >= 200 && response.status < 300) {\r\n            return Promise.resolve(response)\r\n        } else {\r\n            return Promise.reject(new Error(response.statusText))\r\n        }\r\n    },\r\n\r\n    _json: function (response) {\r\n        return response.json()\r\n    },\r\n\r\n    _hide: function (element) {\r\n        element.classList.add('hide');\r\n    },\r\n\r\n    _show: function (element) {\r\n        element.classList.remove('hide');\r\n    },\r\n\r\n\r\n    _grey: function (element) {\r\n        element.classList.remove('is-danger');\r\n        element.classList.remove('is-success');\r\n    },\r\n\r\n\r\n    _green: function (element) {\r\n        element.classList.remove('is-danger');\r\n        element.classList.add('is-success');\r\n    },\r\n\r\n    _red: function (element) {\r\n        element.classList.add('is-danger');\r\n        element.classList.remove('is-success');\r\n    },\r\n\r\n    wallabagUrlChecked: function () {\r\n        if (this.api.data.ApiVersion != '') {\r\n            this.versionLabel_.innerHTML = this.api.data.ApiVersion;\r\n            //            chrome.storage.local.set({ 'wallabagapiversion': this.api.data.ApiVersion });\r\n            this.api.save();\r\n            if (this.api.data.ApiVersion.split('.')[0] == '2') {\r\n                //                chrome.storage.local.set({ 'wallabagchecked': 'OK' });\r\n                this.checkedLabel_.innerHTML = 'OK';\r\n                this._green(this.wallabagurlinput_);\r\n                this._show(this.tokenSection_);\r\n            }\r\n        }\r\n    },\r\n\r\n    wallabagUrlNotChecked: function () {\r\n        this.api.clear();\r\n        this.api.save();\r\n        this._red(this.wallabagurlinput_);\r\n        this._hide(this.tokenSection_);\r\n        this.checkedLabel_.innerHTML = \"Not checked\";\r\n        this.versionLabel_.innerHTML = \"Not checked\";\r\n    },\r\n\r\n\r\n    checkUrlClick: function (e) {\r\n\r\n        e.preventDefault();\r\n\r\n        if (this.wallabagurlinput_.value != '') {\r\n\r\n            this.api.set({ Url: this.protocolLabel_.innerText + this.wallabagurlinput_.value });\r\n\r\n            this.api.CheckUrl()\r\n                .then(data => {\r\n//                    console.log('wallabag url checked: ' + JSON.stringify(data));\r\n                    this.wallabagUrlChecked();\r\n                })\r\n                .catch(error => {\r\n//                    console.log('wallabag url check error: ' + error);\r\n                    this.wallabagUrlNotChecked();\r\n                });\r\n\r\n        }\r\n\r\n    },\r\n\r\n    setFields: function (data) {\r\n            let wburl = data.Url;\r\n            let re = /^(http|https):\\/\\/(.*)/;\r\n            if (re.test(wburl)) {\r\n                res = re.exec(wburl);\r\n                this.protocolCheck_.checked = (res[1] == \"https\");\r\n                this.protocolLabel_.innerText = res[1] + \"://\";\r\n                this.wallabagurlinput_.value = res[2];\r\n            };\r\n            if (this.wallabagurlinput_.value !=''){\r\n                this._show(this.tokenSection_);\r\n            }\r\n            let apiv = data.ApiVersion;\r\n            if ((apiv != '') && (apiv != null)) {\r\n                this.versionLabel_.innerHTML = apiv;\r\n                if (apiv.split('.')[0] == '2') {\r\n                    this.checkedLabel_.innerHTML = 'OK';\r\n                    this._green(this.wallabagurlinput_);\r\n                    this._show(this.tokenSection_);\r\n                }\r\n            }\r\n            let clid = data.ClientId;\r\n            if ((clid != '') && (clid != null)) {\r\n                this.clientId_.value = clid;\r\n            }\r\n            let clsc = data.ClientSecret;\r\n            if ((clsc != '') && (clsc != null)) {\r\n                this.clientSecret_.value = clsc;\r\n            }\r\n            let usrlg = data.UserLogin;\r\n            if ((usrlg != '') && (usrlg != null)) {\r\n                this.userLogin_.value = usrlg;\r\n            }\r\n            let usrp = data.UserPassword;\r\n            if ((usrp != '') && (usrp != null)) {\r\n                this.userPassword_.value = usrp;\r\n            }\r\n            let atoken = data.ApiToken;\r\n            if ((atoken != '') && (atoken != null)) {\r\n                //                this.appTokenInput_.value = atoken;\r\n                this.tokenLabel_.innerHTML = \"Granted\";\r\n            }\r\n            let rtoken = data.RefreshToken;\r\n            if ((rtoken != '') && (rtoken != null)) {\r\n                //             this.refrTokenInput_.value = rtoken;\r\n            }\r\n            let expireDate = this.api.data.ExpireDateMs;\r\n            if ((expireDate != null)) {\r\n          //      this.tokenExpiresInput.value = new Date(expireDate);\r\n                if (this.api.expired) {\r\n                    this.tokenLabel_.innerHTML = \"Expired\"\r\n                }\r\n            }\r\n    },\r\n\r\n    init: function () {\r\n\r\n        this.api = new WallabagApi();\r\n\r\n        this.api.load().then(data => {\r\n            this.setFields(data);\r\n             }).catch(data => { });\r\n\r\n    }\r\n};\r\n\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n    window.PC = new OptionsController();\r\n    PC.init();\r\n});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/options.js\n ** module id = 0\n ** module chunks = 1\n **/"],"sourceRoot":""}